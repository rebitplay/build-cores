<html>

<head>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: white;
    }

    .container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    #game-canvas {
      border: 1px solid black;
    }

    .toolbar {
      margin-bottom: 1rem;
    }
  </style>
</head>

<body>
  <div class="toolbar">
    <button type="button" id="launch-button">Launch</button>
    <button type="button" id="pause-button">Pause</button>
    <button type="button" id="speed2x-button">2x</button>
    <button type="button" id="speed4x-button">4x</button>
  </div>

  <div class="container">
    <canvas id="game-canvas"></canvas>
  </div>

  <script type="module">
    import { Nostalgist } from 'https://esm.run/nostalgist'

    let game = null;
    let started = false

    async function launchGame() {
      game = await Nostalgist.launch({
        core: 'fceumm',
        rom: 'flappybird.nes',
        element: document.getElementById('game-canvas'),
        style: {
          position: 'relative',
          width: '500px',
          height: '400px',
        }
      })

      started = true

      bindEvents()
    }

    document.getElementById('launch-button').addEventListener('click', launchGame)

    function bindEvents() {
      document.getElementById('pause-button').addEventListener('click', () => {
        game.pause()
      })

      document.getElementById('speed2x-button').addEventListener('click', () => {
        game.setSpeed(2)
      })

      document.getElementById('speed4x-button').addEventListener('click', () => {
        game.setSpeed(4)
      })
    }
  </script>
</body>

</html>